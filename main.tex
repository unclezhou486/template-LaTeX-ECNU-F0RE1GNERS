\documentclass[10pt]{article} % 定义文档类为article，基础字号为10pt

% 页面布局设置
\usepackage[left=0.4in,right=0.4in,top=0.7in,bottom=0.4in]{geometry}

% 定义超链接
\usepackage{hyperref}

% 自定义页眉页脚
\usepackage{fancyhdr}

% 代码列表和高亮
\usepackage{listings}
\usepackage{xcolor} % 颜色相关功能
\usepackage{minted} % 代码高亮

% 目录定制
\usepackage{tocloft}

% 支持横向页面
\usepackage{pdflscape}

% 多栏排版
\usepackage{multicol}

% 图形和图片
\usepackage{graphicx}

% 代码样式定制
\usepackage{sourcecodepro}

% 标题样式定制
\usepackage{titlesec}

% 插入PDF页面
\usepackage{pdfpages}

% 定义标题间距
\titlespacing\section{0pt}{15pt}{0pt}
\titlespacing\subsection{0pt}{5pt}{0pt}
\titlespacing\subsubsection{0pt}{5pt}{0pt}

% 设置默认的打字机字体
\renewcommand*{\ttdefault}{pcr}

% 定制目录字体和间距
\renewcommand\cftsecfont{\fontsize{8}{9}\bfseries}
\renewcommand\cftsecpagefont{\fontsize{8}{9}\mdseries}
\renewcommand\cftsubsecfont{\fontsize{5}{6}\mdseries}
\renewcommand\cftsubsecpagefont{\fontsize{5}{6}\mdseries}
\renewcommand\cftsecafterpnum{\vspace{-1ex}}
\renewcommand\cftsubsecafterpnum{\vspace{-1ex}}

% 设置文档的基础字体
\usepackage[sfdefault]{roboto}


\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{white},   % 代码块的背景颜色
    commentstyle=\color{codegreen}, % 注释颜色
    keywordstyle=\color{magenta},   % 关键字颜色
    numberstyle=\tiny\color{codegray}, % 行号颜色
    stringstyle=\color{codepurple}, % 字符串颜色
    basicstyle=\fontsize{8}{8}\ttfamily, % 基本样式
    breaklines=true,                 % 自动换行
    captionpos=b,                    % 标题位置
    keepspaces=false,                % 保持空格
    numbers=left,                    % 行号位置
    numbersep=5pt,                   % 行号与代码之间的间隔
    showspaces=false,                % 显示空格
    showstringspaces=false,           % 显示字符串中的空格
    showtabs=false,                  % 显示制表符
    tabsize=2,                       % 制表符宽度
    xleftmargin=\parindent,          % 左边距
    frame=single,                    % 添加边框
}

\lstset{style=mystyle}

% 定义代码样式
\lstdefinestyle{shared}{
    belowcaptionskip=1\baselineskip, % 代码块标题与代码之间的间距
    breaklines=true, % 自动换行
    xleftmargin=0ex, % 左边距
    showstringspaces=false, % 不显示字符串中的空格
    basicstyle=\fontsize{6}{6}\ttfamily, % 基本样式
    aboveskip=0ex,
    belowskip=0ex
}

% 为不同编程语言定义代码样式
\lstdefinestyle{cpp}{
    style=mystyle,
    language=C++,
    keywordstyle=\bfseries\color{green!40!black},
    commentstyle=\itshape\color{red!80!black},
    identifierstyle=\color{blue},
    stringstyle=\color{purple!40!black},
}

\lstdefinestyle{java}{
    style=shared,
    language=Java,
    keywordstyle=\bfseries\color{green!40!black},
    commentstyle=\itshape\color{purple!40!black},
    identifierstyle=\color{blue},
    stringstyle=\color{orange},
}

\lstdefinestyle{py}{
    style=shared,
    language=Python,
    keywordstyle=\bfseries\color{green!40!black},
    commentstyle=\itshape\color{purple!40!black},
    identifierstyle=\color{blue},
    stringstyle=\color{orange},
}

\lstdefinestyle{txt}{
    style=shared,
}

% 设置代码块的转义字符
\lstset{escapechar=@}

% 设置页眉页脚样式
\pagestyle{fancy}
\fancyhead[L]{East China Normal University} % 左边页眉
\fancyhead[R]{\thepage} % 右边页眉显示页码
\fancyfoot[C]{} % 中间页脚留空

% 设置“plain”页风格
\fancypagestyle{plain}{
    \fancyhead[L]{East China Normal University}
    \fancyhead[R]{\thepage}
    \fancyfoot[C]{}
}

% 文档标题
\title{\vspace{-4ex}\Large{ECNU ICPC \\ Team Reference Document}}
% 作者和日期留空
\author{}
\date{}

\begin{document}

% 以横向模式开始文档，并使用三栏排版
\begin{landscape}
\begin{multicols}{3}

% 制作标题
\maketitle
\vspace{-10ex}

% 显示标题下方的附加信息
\hspace*{-\parindent}%
\begin{minipage}{0.45\linewidth}
\begin{center}
F0RE1GNERS \\
March 2019
\end{center}
\end{minipage}

% 显示目录
\tableofcontents
\pagestyle{fancy}

% 包含文档的主体内容，该文件应该命名为contents.tex
\input contents.tex

% 结束多栏排版
\end{multicols}

% 包含一个PDF页面，显示为文档的最后一页
\includepdf[pages=-]{cheatsheat.pdf}

% 结束横向模式
\end{landscape}

\end{document}
